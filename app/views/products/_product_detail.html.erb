<div class="span6">
  <div class="prd-left-list"> 
    <div id="slideshow-carousel" >       
        <ul id="carousel" class="jcarousel jcarousel-skin-tango">
          <%if @current_variant.present? && @current_variant.image_group.present?%>
              <%if @current_variant.image_group.present?%>
                <% @current_variant.image_group.images.each_with_index do |image,index|%>
                  <li class="prd-thumb" style="width:135px;height:200px;"><a href="#" rel="p<%=index%>"><%= image_tag(image.photo.url(:large),:width=>135,:height=>175) %></a></li>
                <%end%>
              <%end%>
          <% elsif @product.images.size == 0 %>
            <li class="prd-thumb" style="width:135px;height:200px;"><a href="#" rel="p0"><%= image_tag(@product.featured_image(:large),:width=>135,:height=>175) %></a></li>
          <%else%>
            <%@product.images.each_with_index do |i,index|%>
              <li class="prd-thumb" style="width:135px;height:200px;"><a href="#" rel="p<%=index%>"><%= image_tag(i.photo.url(:large),:width=>135,:height=>175) %></a></li>
            <%end%>
          <%end%>  
        </ul>
      </div>
  </div>
  <div id="slideshow-main" class="prd-big-img">
      <ul>
        <%if @current_variant.present? && @current_variant.image_group.present?%>
            <% @current_variant.image_group.images.each_with_index do |image,index|%>
              <li class="p<%=index%> <%= index == 0 ? 'active' : '' %>" style="width:429px;height:640px;">
                <div class="prd-thumb">
                  <a href="#" rel="p<%=index%>">
                    <%= image_tag(image.photo.url(:original),:width=>410) %>
                  </a>
                </div>
              </li>
            <%end%>
        <% elsif @product.images.size == 0 %>
          <li class="p0 active"  style="width:429px;height:640px;">
            <div class="prd-thumb">
              <a href="#" rel="p0">
                <%= image_tag(@product.featured_image(:original),:width=>410) %>
              </a>
            </div>
          </li>
        <%else%>
          <%@product.images.each_with_index do |i,index|%>
            <li class="p<%=index%> <%= index == 0 ? 'active' : '' %>"  style="width:429px;height:640px;">
                <div class="prd-thumb">
                  <a href="#" rel="p<%=index%>">
                    <%= image_tag(i.photo.url(:original),:width=>410) %>
                  </a>
                </div>
              </li>
          <%end%>
        <%end%>
        <%#=@current_variant.present?%>
      </ul>                   
  </div>
</div>
<div class="span6 prd-detail">
  
  <h1>
    <%if current_user%>
      <%if @rock_product.present?%>
        <%=link_to image_tag("/assets/main/fav-icon-blue.png")+"Unfavorite",rock_product_path(@product,:unrock=>true),:remote=>true,:class=>"add-fav"%>
      <%else%>
        <%=link_to image_tag("/assets/main/fav-icon-blue.png")+" Add to favorites",rock_product_path(@product),:remote=>true,:class=>"add-fav"%>
      <%end%>
    <%else%>
      <%=link_to image_tag("/assets/main/fav-icon-blue.png")+" Add to favorites",login_path,:class=>"add-fav"%>
    <%end%>
    <%= @product.name %></h1>
  <div class="add-favted">
    <h3><img src="/assets/main/fav-icon-blue.png" alt=""> Favorited (<%=@product.product_rocks.size%>)</h3>
    <div class="favted-right"><span>5 review(s)</span> | <a href="#">Add Your Review</a></div>
  </div>
  <div class="prd-detail-cat">
    <label>Availability: <span><%=@current_variant.inventory.count_on_hand.to_i%><%if @current_variant.inventory.count_on_hand.to_i <= 0 %>No Stock<% elsif @current_variant.low_stock? %>Low Stock(<%=@current_variant.inventory.count_on_hand%>)<%else%>In Stock<%end%></span></label>
      <label>Variants: <span><%@product.active_variants.each do |v|%>    <%=link_to v.name, change_variant_path(@product.id,v.id),:remote=> true%>  <%end%></span></label>
    <label>Current Variant: <span><%=@current_variant.name%></label>  
    <label>Product Code: <span>483512569</span></label>
    <label>Designer: <span>Allie Walden</span></label>
    <label>Shipping: <span>$12</span></label>
  </div>
  <div class="prd-detail-desc">
    <h4>Description:</h4>
    <p><%= raw @product.description %>
    </p>
  </div>
  <div class="prd-option">
    <!-- <select name="" class="width-160-select">
      <option>Select Color</option>
      <%colors  = @product.active_variants.map{|e| e.color}%>
      <%#if colors.present?%>
        <%# colors.each do |color|%>
          <option style="background-color:<%#=color%>"><%#=color%></option>
        <%#end%>
      <%#end%>
    </select> -->
    <%@product.properties.each_with_index do |pro|%>
      <select name="">
        <option>Select <%=pro.display_name%></option>  
        <%pro.variant_properties.each do |v|%>
          <option><%=v.description%></option>  
        <%end%>
    <%end%>
    <!-- <select name="">
      <option>Select Size</option>
    </select>
    <select name="" class="right">
      <option>1</option>
     </select>-->
  </div>
  <%= form_for  @cart_item,
                :url  => shopping_cart_items_path(@cart_item),
                :html => { :id => 'new_cart_item', :class => '' } do |f| %>
      <%= f.hidden_field :variant_id %>
      <div class=''>
      Quantity:
      <%left_quantity = @current_variant.inventory.present? ? @current_variant.inventory.count_on_hand.to_i : 0%>
      <%= f.select :quantity, (0..left_quantity).to_a, {:include_blank => false}, {:class => ' '} %>
      </div>
      <div class='add_to_cart_wrapper '>
      </div>
      <div class="price-bag"> 
        <span>
          <%= number_to_currency @current_variant.price %>
        </span>
        <% unless @current_variant.present? %>
          <%= link_to 'Add to Bag', '#', :id => 'submit_add_to_cart', :class => 'btn-bag' %>
        <% end %>
      </div>
  <% end %>
  <div class="prd-share">
   
    <div class="bot-blue-line-img"><img src="/assets/main/bot-blue-line.gif" alt=""></div>
    <span>Share:</span>
    <div class="share-div" style="width:84%">
      <!-- AddThis Button BEGIN -->
      <div class="addthis_toolbox addthis_default_style ">
        <span style="width:200px"><a class="addthis_button_facebook_like" fb:like:layout="button_count"></a></span>
        <a class="addthis_button_tweet"></a>
      <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal"></a>
      <a class="addthis_counter addthis_pill_style"></a>
      </div>
      <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=xa-5322fc0a7e8b5fc1"></script>
      <!-- AddThis Button END -->
    </div>
  </div>
</div>
 
<script type="text/javascript">
    $(document).ready(function () {
      
      //jCarousel Plugin
      $('#carousel').jcarousel({
        vertical: true,
        scroll: 1,
        auto: 2,
        wrap: 'last',
        // initCallback: mycarousel_initCallback,
        itemFallbackDimension: 300
      });

    //Front page Carousel - Initial Setup
      $('div#slideshow-carousel a img').css({'opacity': '0.5'});
      $('div#slideshow-carousel a img:first').css({'opacity': '1.0'});
      $('div#slideshow-carousel li a:first').append('<span class="arrow"></span>')

    
      //Combine jCarousel with Image Display
      $('div#slideshow-carousel li a').hover(
          function () {
              
            if (!$(this).has('span').length) {
              $('div#slideshow-carousel li a img').stop(true, true).css({'opacity': '0.5'});
              $(this).stop(true, true).children('img').css({'opacity': '1.0'});
            }   
          },
          function () {
              
            $('div#slideshow-carousel li a img').stop(true, true).css({'opacity': '0.5'});
            $('div#slideshow-carousel li a').each(function () {

              if ($(this).has('span').length) $(this).children('img').css({'opacity': '1.0'});

            });
              
          }
      ).click(function () {

              $('span.arrow').remove();        
        $(this).append('<span class="arrow"></span>');
            $('div#slideshow-main li').removeClass('active');        
            $('div#slideshow-main li.' + $(this).attr('rel')).addClass('active'); 
              
            return false;
      });


    });


    //Carousel Tweaking

    function mycarousel_initCallback(carousel) {
      
      // Pause autoscrolling if the user moves with the cursor over the clip.
      carousel.clip.hover(function() {
        carousel.stopAuto();
      }, function() {
        carousel.startAuto();
      });
    }
    
  </script>

